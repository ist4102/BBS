(()=>{var t={n:a=>{var n=a&&a.__esModule?()=>a.default:()=>a;return t.d(n,{a:n}),n},d:(a,n)=>{for(var s in n)t.o(n,s)&&!t.o(a,s)&&Object.defineProperty(a,s,{enumerable:!0,get:n[s]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";t.r(a);const n=flarum.core.compat["admin/app"];var s=t.n(n);function e(t,a){return e=Object.setPrototypeOf||function(t,a){return t.__proto__=a,t},e(t,a)}const i=flarum.core.compat["common/components/Button"];var r=t.n(i);const o=flarum.core.compat["common/components/LoadingIndicator"];var c=t.n(o);const l=flarum.core.compat["common/components/Select"];var h=t.n(l);const p=flarum.core.compat["common/components/Switch"];var g=t.n(p);const u=flarum.core.compat["admin/components/ExtensionPage"];var f="clarkwinkelmann-catch-the-fish.admin.settings.",d=function(t){var a,n;function i(){for(var a,n=arguments.length,s=new Array(n),e=0;e<n;e++)s[e]=arguments[e];return(a=t.call.apply(t,[this].concat(s))||this).allTagsLoaded=!1,a.loadingAllTags=!1,a.selectedTag="0",a}n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,e(a,n);var o=i.prototype;return o.oninit=function(a){t.prototype.oninit.call(this,a),flarum.extensions["flarum-tags"]&&this.loadAllTags()},o.loadAllTags=function(){var t=this;this.loadingAllTags=!0,s().store.find("tags",{include:"parent,lastPostedDiscussion"}).then((function(){t.loadingAllTags=!1,t.allTagsLoaded=!0,m.redraw()}))},o.content=function(){var t=this;return m(".ExtensionPage-settings",m(".container",[m("h3",s().translator.trans(f+"user")),m(".Form-group",[m("label",s().translator.trans(f+"user-age")),m("input.FormControl",{type:"number",min:1,step:1,bidi:this.setting("catch-the-fish.userAgeDays","14")})]),m(".Form-group",[m("label",s().translator.trans(f+"user-probability")),m("input.FormControl.CTFFormControl--range",{type:"number",min:0,max:100,step:1,bidi:this.setting("catch-the-fish.userProbability","33")}),m("input",{type:"range",min:0,max:100,step:1,bidi:this.setting("catch-the-fish.userProbability","33")})]),m("h3",s().translator.trans(f+"discussion")),m(".Form-group",[m("label",s().translator.trans(f+"discussion-age")),m("input.FormControl",{type:"number",min:1,step:1,bidi:this.setting("catch-the-fish.discussionAgeDays","14")})]),m(".Form-group",[m("label",s().translator.trans(f+"discussion-tags")),m("p.helpText",s().translator.trans(f+"discussion-tags-help")),this.tagSettings()]),m("h3",s().translator.trans(f+"post")),m(".Form-group",[m("label",s().translator.trans(f+"post-age")),m("input.FormControl",{type:"number",min:1,step:1,bidi:this.setting("catch-the-fish.postAgeDays","14")})]),m(".Form-group",[m("label",s().translator.trans(f+"post-probability")),m("input.FormControl.CTFFormControl--range",{type:"number",min:0,max:100,step:1,bidi:this.setting("catch-the-fish.postProbability","50")}),m("input",{type:"range",min:0,max:100,step:1,bidi:this.setting("catch-the-fish.postProbability","50")})]),m("h3",s().translator.trans(f+"general")),m(".Form-group",[m("label",s().translator.trans(f+"time-to-place")),m("input.FormControl",{type:"number",min:1,step:1,bidi:this.setting("catch-the-fish.autoPlacedAfterMinutes","5")})]),m(".Form-group",[g().component({state:"1"===this.setting("catch-the-fish.alertRound","1")(),onchange:function(a){t.setting("catch-the-fish.alertRound")(a?"1":"0")}},s().translator.trans(f+"alert-round"))]),m(".Form-group",[g().component({state:"1"===this.setting("catch-the-fish.animateFlip","1")(),onchange:function(a){t.setting("catch-the-fish.animateFlip")(a?"1":"0")}},s().translator.trans(f+"animate-flip"))]),m(".Form-group",this.submitButton())]))},o.tagSettings=function(){var t=this;if(!flarum.extensions["flarum-tags"])return m("p",m("em",s().translator.trans(f+"discussion-tags-unavailable")));if(this.loadingAllTags)return c().component();var a=[];try{a=JSON.parse(this.setting("catch-the-fish.discussionTags")())}catch(t){}Array.isArray(a)||(a=[]);var n={0:s().translator.trans(f+"tags-control.choose")};return flarum.core.compat["tags/utils/sortTags"](s().store.all("tags")).forEach((function(t){a.some((function(a){return a.tagId===t.id()}))||(n[t.id()]=t.name())})),m("table.CTFTagsTable",[m("thead",m("tr",[m("th",s().translator.trans(f+"tags-header.tag")),m("th",s().translator.trans(f+"tags-header.probability")),m("th")])),m("tbody",[a.map((function(n,e){var i=function(s){n.probability=parseInt(s.target.value),t.setting("catch-the-fish.discussionTags")(JSON.stringify(a))},o=s().store.getById("tags",n.tagId),c=e===a.length-1;return m("tr",[m("td",o?o.name():m("em",n.tagId)),m("td",c?m("em",s().translator.trans(f+"tags-fallback."+(a.length>1?"last-line":"single-line"))):[m("input.FormControl.CTFFormControl--range",{type:"number",min:0,max:100,step:1,value:n.probability||"",onchange:i}),m("input",{type:"range",min:0,max:100,step:1,value:n.probability||"",onchange:i})]),m("td",[" ",r().component({className:"Button Button--icon",icon:"fas fa-chevron-down",onclick:function(){var n;(n=a).splice.apply(n,[e+1,0].concat(a.splice(e,1))),t.setting("catch-the-fish.discussionTags")(JSON.stringify(a))},disabled:c,title:s().translator.trans(f+"tags-control.down")})," ",r().component({className:"Button Button--icon",icon:"fas fa-chevron-up",onclick:function(){var n;(n=a).splice.apply(n,[e-1,0].concat(a.splice(e,1))),t.setting("catch-the-fish.discussionTags")(JSON.stringify(a))},disabled:0===e,title:s().translator.trans(f+"tags-control.up")})," ",r().component({className:"Button Button--icon",icon:"fas fa-times",onclick:function(){a.splice(e,1),t.setting("catch-the-fish.discussionTags")(JSON.stringify(a))},title:s().translator.trans(f+"tags-control.delete")})])])})),m("tr",[m("td",{colspan:2},h().component({options:n,value:this.selectedTag,onchange:function(a){t.selectedTag=a}})),m("td",r().component({className:"Button Button--block",onclick:function(){a.push({tagId:t.selectedTag,probability:50}),t.setting("catch-the-fish.discussionTags")(JSON.stringify(a)),t.selectedTag="0"},disabled:"0"===this.selectedTag},s().translator.trans(f+"tags-control.add")))])])])},i}(t.n(u)());s().initializers.add("clarkwinkelmann-catch-the-fish",(function(){s().extensionData.for("clarkwinkelmann-catch-the-fish").registerPage(d).registerPermission({icon:"fas fa-fish",label:s().translator.trans("clarkwinkelmann-catch-the-fish.admin.permissions.visible"),permission:"catchthefish.visible",allowGuest:!0},"view").registerPermission({icon:"fas fa-fish",label:s().translator.trans("clarkwinkelmann-catch-the-fish.admin.permissions.list-rankings"),permission:"catchthefish.list-rankings",allowGuest:!0},"view").registerPermission({icon:"fas fa-fish",label:s().translator.trans("clarkwinkelmann-catch-the-fish.admin.permissions.participate"),permission:"catchthefish.participate"},"reply").registerPermission({icon:"fas fa-fish",label:s().translator.trans("clarkwinkelmann-catch-the-fish.admin.permissions.choose-place"),permission:"catchthefish.choose-place"},"reply").registerPermission({icon:"fas fa-fish",label:s().translator.trans("clarkwinkelmann-catch-the-fish.admin.permissions.choose-name"),permission:"catchthefish.choose-name"},"reply").registerPermission({icon:"fas fa-fish",label:s().translator.trans("clarkwinkelmann-catch-the-fish.admin.permissions.moderate"),permission:"catchthefish.moderate"},"moderate")}))})(),module.exports=a})();
//# sourceMappingURL=admin.js.map