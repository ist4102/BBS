{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@clarkwinkelmann/catch-the-fish/./node_modules/dayjs/plugin/calendar.js","webpack://@clarkwinkelmann/catch-the-fish/webpack/bootstrap","webpack://@clarkwinkelmann/catch-the-fish/webpack/runtime/compat get default export","webpack://@clarkwinkelmann/catch-the-fish/webpack/runtime/define property getters","webpack://@clarkwinkelmann/catch-the-fish/webpack/runtime/hasOwnProperty shorthand","webpack://@clarkwinkelmann/catch-the-fish/webpack/runtime/make namespace object","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['forum/app']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/Model']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/models/Post']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/models/User']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Fish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Ranking.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Round.ts","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/extend']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['forum/components/HeaderPrimary']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/FishImage.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/Basket.ts","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/DropArea.ts","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/components/Button']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/components/Link']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/User.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/CaughtFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/MovingFish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addDropAreas.ts","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/components/Page']\"","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/RoundRankings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/Rankings.ts","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['common/utils/withAttr']\"","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/EditRound.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/NewRoundModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/EditRoundModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/RoundList.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/EditFish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/NewFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/EditFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/RoundSettings.ts","webpack://@clarkwinkelmann/catch-the-fish/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addNavLinks.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/RoundAlert.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/index.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addModels.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addFishBasket.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addPages.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addRoundAlert.ts"],"sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_calendar=t()}(this,(function(){\"use strict\";return function(e,t,a){var n=\"h:mm A\",d={lastDay:\"[Yesterday at] \"+n,sameDay:\"[Today at] \"+n,nextDay:\"[Tomorrow at] \"+n,nextWeek:\"dddd [at] \"+n,lastWeek:\"[Last] dddd [at] \"+n,sameElse:\"MM/DD/YYYY\"};t.prototype.calendar=function(e,t){var n=t||this.$locale().calendar||d,o=a(e||void 0).startOf(\"d\"),s=this.diff(o,\"d\",!0),i=\"sameElse\",f=s<-6?i:s<-1?\"lastWeek\":s<0?\"lastDay\":s<1?\"sameDay\":s<2?\"nextDay\":s<7?\"nextWeek\":i,l=n[f]||d[f];return\"function\"==typeof l?l.call(this,a()):this.format(l)}}}));","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport Round from './Round';\n\nexport default class Fish extends Model {\n    round_id = Model.attribute('round_id'); // Just for the creation apiEndpoint creation\n    placement = Model.attribute('placement'); // Object\n    name = Model.attribute<string>('name');\n    image_url = Model.attribute<string>('image_url');\n    canSee = Model.attribute<boolean>('canSee');\n    canCatch = Model.attribute<boolean>('canCatch');\n    canName = Model.attribute<boolean>('canName');\n    canPlace = Model.attribute<boolean>('canPlace');\n    placeUntil = Model.attribute('placeUntil');\n    namedBy = Model.hasOne<User>('lastUserNaming');\n    placedBy = Model.hasOne<User>('lastUserPlacement');\n    round = Model.hasOne<Round>('round');\n    placementModel = Model.hasOne<User | Discussion | Post>('placement'); // Only used by the admin panel to show the link to the resource\n\n    apiEndpoint() {\n        return '/catch-the-fish/' + (this.exists ? 'fishes/' + this.data.id : 'rounds/' + this.data.attributes.round_id + '/fishes');\n    }\n}\n","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\n\nexport default class Ranking extends Model {\n    catch_count = Model.attribute('catch_count');\n    user: () => User = Model.hasOne('user');\n}\n","import Model from 'flarum/common/Model';\nimport Ranking from './Ranking';\n\nexport default class Round extends Model {\n    name = Model.attribute('name');\n    starts_at = Model.attribute('starts_at');\n    ends_at = Model.attribute('ends_at');\n    include_starting_pack = Model.attribute<boolean>('include_starting_pack');\n    myRanking = Model.hasOne<Ranking>('myRanking');\n\n    apiEndpoint() {\n        return '/catch-the-fish/rounds' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/HeaderPrimary'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport extractText from 'flarum/common/utils/extractText';\nimport Fish from '../models/Fish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.fish-image.';\n\ninterface FishImageAttrs {\n    fish: Fish\n    animationDuration?: string\n}\n\nexport default class FishImage implements ClassComponent<FishImageAttrs> {\n    view(vnode: Vnode<FishImageAttrs, this>) {\n        const src = vnode.attrs.fish.image_url();\n\n        if (src) {\n            return m('img.catchthefish-image', {\n                alt: extractText(app.translator.trans(translationPrefix + 'alt', {\n                    name: vnode.attrs.fish.name(),\n                })),\n                src,\n                style: {\n                    animationDuration: vnode.attrs.animationDuration || '10s',\n                },\n                draggable: false, // Without this, browsers somehow drag the image URL across windows instead of the drop data\n            });\n        }\n\n        return m('.catchthefish-no-image', app.translator.trans(translationPrefix + 'missing'));\n    }\n}\n","import {ClassComponent} from 'mithril';\nimport app from 'flarum/forum/app';\nimport User from 'flarum/common/models/User';\nimport FishImage from './FishImage';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.basket.';\n\nexport default class Basket implements ClassComponent {\n    view() {\n        if (!app.session.user) {\n            return m('div');\n        }\n\n        const basket = (app.session.user as User).catchTheFishBasket();\n\n        if (!basket) {\n            return m('div');\n        }\n\n        const fishesThatCanBePlaced = basket.filter(fish => fish.canPlace());\n\n        if (fishesThatCanBePlaced.length === 0) {\n            return m('div');\n        }\n\n        return m('.catchthefish-basket', [\n            m('.catchthefish-basket-title', app.translator.trans(translationPrefix + 'title')),\n            m('p', app.translator.trans(translationPrefix + 'drag-help')),\n            fishesThatCanBePlaced.map(fish => m('.catchthefish-basket-entry', [\n                m('.catchthefish-basket-fish', {\n                    draggable: true,\n                    ondragstart(event: DragEvent) {\n                        if (!event.dataTransfer) {\n                            return;\n                        }\n\n                        // Used for internal drag and drop animation\n                        app.draggedFishId = fish.id();\n\n                        // Used for cross-window drag and drop\n                        // Chrome doesn't allow reading this value in ondragover so we can't show a drop area in that situation\n                        // (we would have to show a drop area for all text drops, which is too broad)\n                        event.dataTransfer.setData('text/plain', 'fish:' + fish.id());\n                    },\n                }, m(FishImage, {\n                    fish,\n                })),\n                m('.catchthefish-basket-time', app.translator.trans(translationPrefix + 'time', {\n                    time: dayjs(fish.placeUntil()).fromNow(),\n                })),\n            ])),\n        ]);\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionHero'];","import {ClassComponent} from 'mithril';\nimport app from 'flarum/forum/app';\n\nexport default class DropArea implements ClassComponent {\n    view() {\n        return m('.catchthefish-drop-area', app.translator.trans('clarkwinkelmann-catch-the-fish.forum.drop-area.message'));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Link from 'flarum/common/components/Link';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport UserModel from 'flarum/common/models/User';\n\ninterface UserAttrs {\n    user: UserModel\n}\n\nexport default class User implements ClassComponent<UserAttrs> {\n    view(vnode: Vnode<UserAttrs, this>) {\n        const {user} = vnode.attrs;\n\n        return m(Link, {\n            href: app.route.user(user),\n        }, [\n            avatar(user),\n            ' ',\n            username(user),\n        ]);\n    }\n}\n","import {Vnode} from 'mithril'\nimport app from 'flarum/forum/app';\nimport Modal, {IInternalModalAttrs} from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport FishImage from '../components/FishImage';\nimport User from '../components/User';\nimport Fish from '../models/Fish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.caught-fish-modal.';\n\ninterface CaughtFishModalAttrs extends IInternalModalAttrs {\n    fish: Fish\n}\n\nexport default class CaughtFishModal extends Modal<CaughtFishModalAttrs> {\n    newName!: string\n    dirty: boolean = false\n    loading: boolean = false\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.newName = this.attrs.fish.name();\n    }\n\n    className() {\n        return 'Modal--small catchthefish-catch-modal';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    saveNameAndPlacement(randomPlacement = false) {\n        const body: any = {};\n\n        if (this.dirty) {\n            body.name = this.newName;\n        }\n\n        if (randomPlacement) {\n            body.placement = 'random';\n        }\n\n        if (body) {\n            this.loading = true;\n\n            app.request({\n                method: 'POST',\n                url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + this.attrs.fish.id() + '/place',\n                body,\n            }).then(result => {\n                app.store.pushPayload(result);\n                this.hide();\n\n                if (this.attrs.fish.canPlace() && !randomPlacement) {\n                    // Refresh basket by reloading user\n                    app.store.find('users', app.session.user!.id()!).then(() => {\n                        m.redraw();\n                    });\n                }\n            }).catch(err => {\n                this.loading = false;\n                m.redraw();\n                throw err;\n            });\n        } else {\n            this.hide();\n\n            if (this.attrs.fish.canPlace() && !randomPlacement) {\n                // Refresh basket by reloading user\n                app.store.find('users', app.session.user!.id()!).then(() => {\n                    m.redraw();\n                });\n            }\n        }\n    }\n\n    content() {\n        const {fish} = this.attrs;\n\n        const namedBy = fish.namedBy();\n        const placedBy = fish.placedBy();\n\n        return m('.Modal-body', [\n            m('h3', '\"' + fish.name() + '\"'),\n            m(FishImage, {\n                fish,\n            }),\n            namedBy ? m('p', [\n                app.translator.trans(translationPrefix + 'named-by'),\n                ' ',\n                m(User, {\n                    user: namedBy,\n                }),\n            ]) : null,\n            placedBy ? m('p', [\n                app.translator.trans(translationPrefix + 'placed-by'),\n                ' ',\n                m(User, {\n                    user: placedBy,\n                }),\n            ]) : null,\n            m('p', app.translator.trans(translationPrefix + 'congratulation', {\n                catch_count: fish.round()!.myRanking()?.catch_count(),\n            })),\n            fish.canName() ? m('.Form-group', [\n                m('p', app.translator.trans(translationPrefix + 'name-help')),\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.newName,\n                    oninput: (event: Event) => {\n                        this.newName = (event.target as HTMLInputElement).value;\n                        this.dirty = true;\n                    },\n                }),\n            ]) : null,\n            fish.canPlace() ? m('p', app.translator.trans(translationPrefix + 'placement-help')) : null,\n            m('.Form-group', Button.component({\n                className: 'Button Button--primary Button--block',\n                type: 'button',\n                loading: this.loading,\n                onclick: () => {\n                    this.saveNameAndPlacement();\n                },\n            }, app.translator.trans(translationPrefix + (this.dirty ? (fish.canPlace() ? 'submit-name-place-later' : 'submit-name') : (fish.canPlace() ? 'submit-place-later' : 'submit-continue'))))),\n            fish.canPlace() ? m('.Form-group', Button.component({\n                className: 'Button Button--primary Button--block',\n                type: 'button',\n                loading: this.loading,\n                onclick: () => {\n                    this.saveNameAndPlacement(true);\n                },\n            }, app.translator.trans(translationPrefix + (this.dirty ? 'submit-name-place-random' : 'submit-place-random')))) : null,\n        ]);\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n        // Because the modal has its own form, pressing enter will submit here\n        // In this case we apply the same feature as the first button\n        this.saveNameAndPlacement();\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport classList from 'flarum/common/utils/classList';\nimport FishImage from './FishImage';\nimport CaughtFishModal from '../modals/CaughtFishModal';\nimport Fish from '../models/Fish';\n\ninterface MovingFishAttrs {\n    fish: Fish\n    oncatch?: () => void\n}\n\nexport default class MovingFish implements ClassComponent<MovingFishAttrs> {\n    reverseAnimation!: boolean\n    animationDuration!: string\n\n    oninit() {\n        this.reverseAnimation = Math.random() > 0.5;\n        this.animationDuration = 5 + (Math.floor(Math.random() * 70) / 10) + 's';\n    }\n\n    view(vnode: Vnode<MovingFishAttrs, this>) {\n        const {fish} = vnode.attrs;\n\n        return m('.catchthefish-moving-fish', {\n            className: classList({\n                'catchthefish-animate-flip': app.forum.catchTheFishAnimateFlip(),\n                'catchthefish-animate-reverse': this.reverseAnimation,\n            }),\n            style: {\n                animationDuration: this.animationDuration,\n            },\n            onclick: () => {\n                if (!fish.canCatch() && !app.session.user) {\n                    alert(app.translator.trans('clarkwinkelmann-catch-the-fish.forum.moving-fish.login'));\n                    return;\n                }\n\n                app.request({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + fish.id() + '/catch',\n                    body: fish.placement(),\n                }).then(result => {\n                    app.modal.show(CaughtFishModal, {\n                        fish: app.store.pushPayload(result),\n                    });\n\n                    // So the parent can remove the fish from the relationship\n                    if (vnode.attrs.oncatch) {\n                        vnode.attrs.oncatch();\n                    }\n                });\n            },\n        }, [\n            m('.catchthefish-name', fish.name()),\n            m(FishImage, {\n                fish,\n                animationDuration: this.animationDuration,\n            }),\n        ]);\n    }\n}\n","import {extend, override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SubtreeRetainer from 'flarum/common/utils/SubtreeRetainer';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DropArea from './components/DropArea';\nimport MovingFish from './components/MovingFish';\n\ninterface DragOverComponent {\n    fishDragOver: boolean\n    subtree?: SubtreeRetainer\n    attrs?: any\n}\n\nfunction fishIdFromEvent(event: DragEvent): string | null {\n    if (!event.dataTransfer) {\n        return null;\n    }\n\n    const data = event.dataTransfer.getData(\"text/plain\");\n\n    const match = /^fish:([0-9]+)$/.exec(data);\n\n    return match ? match[1] : null;\n}\n\nfunction movingFishContent(dragover: boolean, model: any) {\n    const content = [];\n\n    if (dragover) {\n        content.push(m(DropArea));\n    }\n\n    const fishes = model.catchTheFishFishes();\n\n    if (fishes) {\n        fishes.forEach(fish => {\n            if (!fish.canSee()) {\n                return;\n            }\n\n            // Remove fish from relationship\n            content.push(m(MovingFish, {\n                fish,\n                oncatch: () => {\n                    model.pushData({\n                        relationships: {\n                            catchTheFishFishes: {\n                                data: model.data.relationships.catchTheFishFishes.data.filter(f => f.id !== fish.id()),\n                            },\n                        },\n                    });\n                },\n            }));\n        });\n    }\n\n    return content;\n}\n\nfunction addDropAttrs(this: DragOverComponent, attrs: any, modelProperty: string) {\n    attrs.ondrop = (event: DragEvent) => {\n        this.fishDragOver = false;\n\n        const fishId = app.draggedFishId || fishIdFromEvent(event);\n\n        if (fishId) {\n            event.preventDefault();\n\n            const fish = app.store.getById('catchthefish-fishes', fishId);\n\n            if (fish) {\n                const placement: any = {};\n                placement[modelProperty + '_id'] = this.attrs[modelProperty].id();\n\n                app.request({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + fish.id() + '/place',\n                    body: {\n                        placement,\n                    },\n                }).then(result => {\n                    app.store.pushPayload(result);\n\n                    // Refresh basket by reloading user\n                    app.store.find('users', app.session.user.id()).then(() => {\n                        m.redraw();\n                    });\n                });\n            } else {\n                alert(app.translator.trans('clarkwinkelmann-catch-the-fish.forum.drop-area.missing-from-store'));\n            }\n        }\n    };\n    attrs.ondragover = (event: DragEvent) => {\n        if (app.draggedFishId || fishIdFromEvent(event)) {\n            event.preventDefault();\n            event.dataTransfer!.dropEffect = 'move';\n\n            if (this.fishDragOver) {\n                event.redraw = false;\n            } else {\n                this.fishDragOver = true;\n                m.redraw();\n            }\n        } else {\n            // In order to still support drag and drop across windows, we will accept any text drops\n            // This is necessary because browsers don't give access to the drop value until the actual drop\n            // But if we don't call preventDefault() here the drop can't happen in the first place\n            if (event.dataTransfer && event.dataTransfer.types.includes('text/plain')) {\n                event.preventDefault();\n            }\n\n            event.redraw = false;\n        }\n    };\n    attrs.ondragenter = (event: DragEvent) => {\n        event.preventDefault();\n        event.redraw = false;\n    };\n    attrs.ondragleave = (event: DragEvent) => {\n        if (this.fishDragOver) {\n            this.fishDragOver = false;\n            m.redraw();\n        } else {\n            event.redraw = false;\n        }\n    };\n}\n\nfunction addAreaToComponent(component: DragOverComponent, viewName: string, modelProperty: string) {\n    if (viewName === 'content') {\n        override(component, viewName, function (original: any) {\n            return original().concat(movingFishContent(this.fishDragOver, this.attrs[modelProperty]));\n        });\n    } else {\n        extend(component, viewName, function (items: ItemList<any>) {\n            items.add('catchthefish-fish-and-drop', movingFishContent(this.fishDragOver, this.attrs[modelProperty]));\n        });\n    }\n\n    extend(component, 'oninit', function () {\n        this.fishDragOver = false;\n\n        // Add a condition to the post tree retainer\n        if (this.subtree) {\n            this.subtree.check(() => this.fishDragOver);\n        }\n    });\n\n    if (viewName === 'content') {\n        // CommentPost has an attrs() method we can extend\n        extend(component, 'elementAttrs', function (attrs) {\n            addDropAttrs.bind(this)(attrs, modelProperty);\n        });\n    } else {\n        // For other elements we manually add attrs to the vdom of the view\n        extend(component, 'view', function (vdom) {\n            vdom.attrs = vdom.attrs || {};\n            addDropAttrs.bind(this)(vdom.attrs, modelProperty);\n        });\n    }\n}\n\nexport default function () {\n    addAreaToComponent(CommentPost.prototype as any, 'content', 'post');\n    addAreaToComponent(UserCard.prototype as any, 'infoItems', 'user');\n    addAreaToComponent(DiscussionHero.prototype as any, 'items', 'discussion');\n\n    document.addEventListener('dragend', () => {\n        app.draggedFishId = null;\n    });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport User from './User';\nimport Ranking from '../models/Ranking';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-ranking.';\n\ninterface RoundRankingsAttrs {\n    round: Round\n}\n\nexport default class RoundRankings implements ClassComponent<RoundRankingsAttrs> {\n    rankings: Ranking[] | null = null;\n\n    oninit(vnode: Vnode<RoundRankingsAttrs, this>) {\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds/' + vnode.attrs.round.id() + '/rankings',\n        }).then(result => {\n            this.rankings = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    view(vnode: Vnode<RoundRankingsAttrs, this>) {\n        if (this.rankings === null) {\n            return m('p', app.translator.trans(translationPrefix + 'loading'));\n        }\n\n        return m('div', [\n            m('h2', app.translator.trans(translationPrefix + 'title', {\n                name: vnode.attrs.round.name(),\n            })),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'rank')),\n                    m('th', app.translator.trans(translationPrefix + 'count')),\n                    m('th', app.translator.trans(translationPrefix + 'user')),\n                ])),\n                m('tbody', this.rankings.map((ranking, index) => m('tr', [\n                    m('td', '#' + (index + 1)),\n                    m('td', ranking.catch_count()),\n                    m('td', m(User, {\n                        user: ranking.user(),\n                    })),\n                ]))),\n            ]),\n        ]);\n    }\n}\n","import app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport RoundRankings from \"../components/RoundRankings\";\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.page-ranking.';\n\nexport default class Rankings extends Page {\n    view() {\n        if (!app.forum.catchTheFishCanSeeRankingsPage()) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'permission')));\n        }\n\n        const rounds = app.forum.catchTheFishActiveRounds();\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title')),\n            rounds ? rounds.map(round => m(RoundRankings, {\n                round,\n            })) : m('p', app.translator.trans(translationPrefix + 'nothing')),\n        ]);\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/withAttr'];","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport Switch from 'flarum/common/components/Switch';\nimport extractText from 'flarum/common/utils/extractText';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-round.';\n\ninterface EditRoundAttrs {\n    round?: Round\n    onsave?: () => void\n    ondelete?: () => void\n}\n\nexport default class EditRound implements ClassComponent<EditRoundAttrs> {\n    round!: Round\n    dirty: boolean = false\n    processing: boolean = false\n\n    oninit(vnode: Vnode<EditRoundAttrs, this>) {\n        let {round} = vnode.attrs;\n\n        if (typeof round === 'undefined') {\n            round = app.store.createRecord('catchthefish-rounds', {\n                attributes: {\n                    name: '',\n                    starts_at: '',\n                    ends_at: dayjs().add(1, 'day').toISOString(),\n                    include_starting_pack: true,\n                },\n            }) as Round;\n        }\n\n        this.round = round;\n    }\n\n    view(vnode: Vnode<EditRoundAttrs, this>) {\n        return m('form', {\n            onsubmit: (event: Event) => {\n                event.preventDefault();\n                this.saveRecord(vnode);\n            },\n        }, [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.round.name(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'name')),\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'name-help')),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'starts-at')),\n                m('input.FormControl', {\n                    value: this.round.starts_at(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'starts_at')),\n                }),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'ends-at')),\n                m('input.FormControl', {\n                    value: this.round.ends_at(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'ends_at')),\n                }),\n            ]),\n            this.round.exists ? '' : m('.Form-group', [\n                m('label', [\n                    Switch.component({\n                        state: this.round.include_starting_pack(),\n                        onchange: this.updateAttribute.bind(this, 'include_starting_pack'),\n                    }, app.translator.trans(translationPrefix + 'starting-pack')),\n                ]),\n                m('.helpText', app.translator.trans(translationPrefix + 'starting-pack-help')),\n            ]),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                }, app.translator.trans(translationPrefix + (this.round.exists ? 'save' : 'create'))),\n                (this.round.exists ? Button.component({\n                    type: 'button',\n                    className: 'Button Button--danger',\n                    loading: this.processing,\n                    onclick: () => {\n                        this.deleteRecord(vnode);\n                    },\n                }, app.translator.trans(translationPrefix + 'delete')) : ''),\n            ]),\n        ]);\n    }\n\n    updateAttribute(attribute: string, value: any) {\n        this.round.pushAttributes({\n            [attribute]: value,\n        });\n\n        this.dirty = true;\n    }\n\n    readyToSave() {\n        if (!this.round.name()) {\n            return false;\n        }\n\n        return this.dirty;\n    }\n\n    saveRecord(vnode: Vnode<EditRoundAttrs, this>) {\n        this.processing = true;\n\n        this.round.save(this.round.data.attributes).then(() => {\n            if (vnode.attrs.onsave) {\n                vnode.attrs.onsave();\n            }\n\n            this.processing = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    deleteRecord(vnode: Vnode<EditRoundAttrs, this>) {\n        if (!confirm(extractText(app.translator.trans(translationPrefix + 'delete-confirmation', {\n            name: this.round.name(),\n        })))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.round.delete().then(() => {\n            if (vnode.attrs.ondelete) {\n                vnode.attrs.ondelete();\n            }\n\n            this.processing = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditRound from '../components/EditRound';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.new-round-modal.';\n\nexport default class NewRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    content() {\n        return m('.Modal-body', m(EditRound, {\n            onsave: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditRound from '../components/EditRound';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-round-modal.';\n\nexport default class EditRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title', {\n            name: this.attrs.round.name(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m(EditRound, {\n            round: this.attrs.round,\n            ondelete: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport Button from 'flarum/common/components/Button';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport NewRoundModal from '../modals/NewRoundModal';\nimport EditRoundModal from '../modals/EditRoundModal';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-round.';\n\nexport default class RoundList extends Page {\n    rounds: Round[] | null = null\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.refreshRounds();\n    }\n\n    refreshRounds() {\n        this.rounds = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds',\n        }).then(result => {\n            this.rounds = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    view() {\n        if (this.rounds === null) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'loading')));\n        }\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title')),\n            Button.component({\n                className: 'Button Button--primary',\n                onclick: () => {\n                    app.modal.show(NewRoundModal, {\n                        oncreateordelete: () => {\n                            this.refreshRounds();\n                        },\n                    });\n                },\n            }, app.translator.trans(translationPrefix + 'new')),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'name')),\n                    m('th', app.translator.trans(translationPrefix + 'start')),\n                    m('th', app.translator.trans(translationPrefix + 'end')),\n                    m('th', app.translator.trans(translationPrefix + 'actions')),\n                ])),\n                m('tbody', this.rounds.map(round => m('tr', [\n                    m('td', round.name()),\n                    m('td', round.starts_at()),\n                    m('td', round.ends_at()),\n                    m('td', [\n                        Button.component({\n                            className: 'Button',\n                            onclick: () => {\n                                app.modal.show(EditRoundModal, {\n                                    round,\n                                    oncreateordelete: () => {\n                                        this.refreshRounds();\n                                    },\n                                });\n                            },\n                        }, app.translator.trans(translationPrefix + 'edit')),\n                        ' ',\n                        LinkButton.component({\n                            className: 'Button',\n                            href: app.route('catchTheFishRound', {\n                                id: round.id(),\n                            }),\n                        }, app.translator.trans(translationPrefix + 'fishes')),\n                    ]),\n                ]))),\n            ]),\n        ]);\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport Fish from '../models/Fish';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-fish.';\n\ninterface EditFishAttrs {\n    fish?: Fish\n    round: Round\n    onsave?: () => void\n    ondelete?: () => void\n}\n\nexport default class EditFish implements ClassComponent<EditFishAttrs> {\n    fish!: Fish\n    dirty: boolean = false\n    processing: boolean = false\n\n    oninit(vnode: Vnode<EditFishAttrs, this>) {\n        let {fish} = vnode.attrs;\n        if (typeof fish === 'undefined') {\n            fish = app.store.createRecord('catchthefish-fishes', {\n                attributes: {\n                    round_id: vnode.attrs.round.id(),\n                    name: '',\n                },\n            }) as Fish;\n        }\n\n        this.fish = fish;\n    }\n\n    view(vnode: Vnode<EditFishAttrs, this>) {\n        return m('form', {\n            onsubmit: (event: Event) => {\n                event.preventDefault();\n                this.saveRecord(vnode);\n            },\n        }, [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.fish.name(),\n                    oninput: (event: Event) => {\n                        this.fish.pushAttributes({\n                            name: (event.target as HTMLInputElement).value,\n                        });\n\n                        this.dirty = true;\n                    },\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'name-help')),\n            ]),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                }, app.translator.trans(translationPrefix + (this.fish.exists ? 'save' : 'create'))),\n                (this.fish.exists ? Button.component({\n                    type: 'button',\n                    className: 'Button Button--danger',\n                    loading: this.processing,\n                    onclick: () => {\n                        this.deleteRecord(vnode);\n                    },\n                }, app.translator.trans(translationPrefix + 'delete')) : ''),\n            ]),\n        ]);\n    }\n\n    readyToSave() {\n        if (!this.fish.name()) {\n            return false;\n        }\n\n        return this.dirty;\n    }\n\n    saveRecord(vnode: Vnode<EditFishAttrs, this>) {\n        this.processing = true;\n\n        this.fish.save(this.fish.data.attributes).then(() => {\n            if (vnode.attrs.onsave) {\n                vnode.attrs.onsave();\n            }\n\n            this.processing = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    deleteRecord(vnode: Vnode<EditFishAttrs, this>) {\n        if (!confirm(extractText(app.translator.trans(translationPrefix + 'delete-confirmation', {\n            name: this.fish.name(),\n        })))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.fish.delete().then(() => {\n            if (vnode.attrs.ondelete) {\n                vnode.attrs.ondelete();\n            }\n\n            this.processing = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditFish from '../components/EditFish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.new-fish-modal.';\n\nexport default class NewFishModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    content() {\n        return m('.Modal-body', m(EditFish, {\n            round: this.attrs.round,\n            onsave: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditFish from '../components/EditFish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-fish-modal.';\n\nexport default class EditRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title', {\n            name: this.attrs.fish.name(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m(EditFish, {\n            fish: this.attrs.fish,\n            ondelete: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Link from 'flarum/common/components/Link';\nimport Page from 'flarum/common/components/Page';\nimport Button from 'flarum/common/components/Button';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport UserModel from 'flarum/common/models/User';\nimport NewFishModal from '../modals/NewFishModal';\nimport EditFishModal from '../modals/EditFishModal';\nimport FishImage from '../components/FishImage';\nimport User from '../components/User';\nimport Fish from '../models/Fish';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-fish.';\n\nexport default class RoundSettings extends Page {\n    roundId!: string\n    round: Round | null = null\n    fishes: Fish[] | null = null\n    uploading: boolean = false\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.roundId = m.route.param('id');\n        this.round = app.store.getById('catchthefish-round', this.roundId);\n\n        if (!this.round) {\n            app.store.find('catch-the-fish/rounds', this.roundId).then(round => {\n                this.round = round;\n                m.redraw();\n            });\n        }\n\n        this.refreshFishes();\n    }\n\n    refreshFishes() {\n        this.fishes = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds/' + this.roundId + '/fishes',\n        }).then(result => {\n            this.fishes = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    // Based on Flarum's AvatarEditor component\n    openPicker(callback: (files: FileList) => void, multiple = false) {\n        if (this.uploading) return;\n\n        const $input = $('<input type=\"file\">');\n        // @ts-ignore should the variable be cast to string?\n        $input.attr('multiple', multiple);\n        $input.appendTo('body').hide().click().on('change', event => {\n            callback((event.target as HTMLInputElement).files as FileList);\n        });\n    }\n\n    uploadImages(images: FileList, fish?: Fish) {\n        const body = new FormData();\n\n        if (fish) {\n            body.append('image', images[0]);\n        } else {\n            for (let i = 0; i < images.length; i++) {\n                body.append('image' + i, images[i]);\n            }\n        }\n\n        this.uploading = true;\n        m.redraw();\n\n        app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/' + (fish ? 'fishes/' + fish.id() + '/image' : 'rounds/' + this.roundId + '/fishes-from-images'),\n            serialize: (raw: any) => raw,\n            body,\n        }).then(() => {\n            this.uploading = false;\n            m.redraw();\n            this.refreshFishes();\n        }).catch(err => {\n            this.uploading = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    view() {\n        if (!this.round || this.fishes === null) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'loading')));\n        }\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title', {\n                name: this.round.name(),\n            })),\n            Button.component({\n                className: 'Button Button--primary',\n                onclick: () => {\n                    app.modal.show(NewFishModal, {\n                        round: this.round,\n                        oncreateordelete: () => {\n                            this.refreshFishes();\n                        },\n                    });\n                },\n            }, app.translator.trans(translationPrefix + 'new')),\n            ' ',\n            Button.component({\n                className: 'Button',\n                type: 'button',\n                onclick: () => {\n                    this.openPicker(files => {\n                        this.uploadImages(files);\n                    }, true);\n                },\n                loading: this.uploading,\n            }, app.translator.trans(translationPrefix + 'new-from-image')),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'image')),\n                    m('th', app.translator.trans(translationPrefix + 'name')),\n                    m('th', app.translator.trans(translationPrefix + 'user-name')),\n                    m('th', app.translator.trans(translationPrefix + 'user-place')),\n                    m('th', app.translator.trans(translationPrefix + 'placement')),\n                    m('th', app.translator.trans(translationPrefix + 'actions')),\n                ])),\n                m('tbody', this.fishes.length === 0 ? m('tr', [\n                    m('td', 'No fishes'),\n                ]) : this.fishes.map(fish => {\n                    const namedBy = fish.namedBy();\n                    const placedBy = fish.placedBy();\n\n                    return m('tr', [\n                        m('td', m(FishImage, {\n                            fish,\n                        })),\n                        m('td', fish.name()),\n                        m('td', namedBy ? m(User, {\n                            user: namedBy,\n                        }) : m('em', app.translator.trans(translationPrefix + 'no-user-name'))),\n                        m('td', placedBy ? m(User, {\n                            user: placedBy,\n                        }) : m('em', app.translator.trans(translationPrefix + 'no-user-place'))),\n                        m('td', this.placement(fish)),\n                        m('td', [\n                            Button.component({\n                                className: 'Button',\n                                onclick: () => {\n                                    app.modal.show(EditFishModal, {\n                                        fish,\n                                        oncreateordelete: () => {\n                                            this.refreshFishes();\n                                        },\n                                    });\n                                },\n                            }, app.translator.trans(translationPrefix + 'edit')),\n                            ' ',\n                            Button.component({\n                                className: 'Button',\n                                type: 'button',\n                                onclick: () => {\n                                    this.openPicker(files => {\n                                        this.uploadImages(files, fish);\n                                    });\n                                },\n                                loading: this.uploading,\n                            }, app.translator.trans(translationPrefix + 'upload')),\n                        ]),\n                    ]);\n                })),\n            ]),\n        ]);\n    }\n\n    placement(fish: Fish): any {\n        const placement = fish.placementModel();\n\n        if (placement instanceof Discussion) {\n            return m(Link, {\n                href: app.route.discussion(placement),\n            }, placement.title());\n        }\n\n        if (placement instanceof Post) {\n            const discussion = placement.discussion();\n\n            return m(Link, {\n                href: app.route.post(placement),\n            }, (discussion ? discussion.title() : '') + ' #' + placement.number());\n        }\n\n        if (placement instanceof UserModel) {\n            return m(User, {\n                user: placement,\n            });\n        }\n\n        return 'N/A';\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","import {extend} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.nav.';\n\nexport default function () {\n    extend(IndexPage.prototype, 'navItems', function (items: ItemList) {\n        if (app.forum.catchTheFishCanSeeRankingsPage()) {\n            items.add('catchthefish-rankings', LinkButton.component({\n                icon: 'fas fa-fish',\n                href: app.route('catchTheFishRankings'),\n            }, app.translator.trans(translationPrefix + 'rankings')));\n        }\n\n        if (app.forum.catchTheFishCanModerate()) {\n            items.add('catchthefish-settings', LinkButton.component({\n                icon: 'fas fa-fish',\n                href: app.route('catchTheFishRounds'),\n            }, app.translator.trans(translationPrefix + 'settings')));\n        }\n    });\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.round-alert.';\n\ninterface UpdateAlertAttrs {\n    round: Round\n}\n\nexport default class UpdateAlert implements ClassComponent<UpdateAlertAttrs> {\n    view(vnode: Vnode<UpdateAlertAttrs, this>) {\n        return m('.Alert.Alert-info', m('.container', [\n            m('span.Alert-body', [\n                app.translator.trans(translationPrefix + 'message', {\n                    name: vnode.attrs.round.name(),\n                    time: dayjs(vnode.attrs.round.ends_at()).calendar(),\n                }),\n            ]),\n            app.forum.catchTheFishCanSeeRankingsPage() ? m('ul.Alert-controls', m('li', LinkButton.component({\n                href: app.route('catchTheFishRankings'),\n            }, app.translator.trans(translationPrefix + 'rankings')))) : null,\n        ]));\n    }\n}\n","import app from 'flarum/forum/app';\nimport addModels from './addModels';\nimport addFishBasket from './addFishBasket';\nimport addDropAreas from './addDropAreas';\nimport addPages from './addPages';\nimport addNavLinks from './addNavLinks';\nimport addRoundAlert from './addRoundAlert';\nimport calendar from 'dayjs/plugin/calendar';\n\n// Import calendar plugin for Day.js\ndayjs.extend(calendar)\n\napp.initializers.add('clarkwinkelmann-catch-the-fish', () => {\n    addModels();\n    addFishBasket();\n    addDropAreas();\n    addPages();\n    addNavLinks();\n    addRoundAlert();\n});\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport User from 'flarum/common/models/User';\nimport Forum from 'flarum/common/models/Forum';\nimport Fish from './models/Fish';\nimport Ranking from './models/Ranking';\nimport Round from './models/Round';\n\nexport default function () {\n    app.store.models['catchthefish-fishes'] = Fish;\n    app.store.models['catchthefish-rankings'] = Ranking;\n    app.store.models['catchthefish-rounds'] = Round;\n\n    Discussion.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    Post.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    User.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    User.prototype.catchTheFishBasket = Model.hasMany('catchTheFishBasket');\n    Forum.prototype.catchTheFishActiveRounds = Model.hasMany('catchTheFishActiveRounds');\n    Forum.prototype.catchTheFishCanModerate = Model.attribute('catchTheFishCanModerate');\n    Forum.prototype.catchTheFishCanSeeRankingsPage = Model.attribute('catchTheFishCanSeeRankingsPage');\n    Forum.prototype.catchTheFishAnimateFlip = Model.attribute('catchTheFishAnimateFlip');\n}\n","import {extend} from 'flarum/common/extend';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport HeaderPrimary from 'flarum/forum/components/HeaderPrimary';\nimport Basket from './components/Basket';\n\nexport default function () {\n    extend(HeaderPrimary.prototype, 'items', function (items: ItemList) {\n        items.add('catchthefish-basket', m(Basket));\n    });\n}\n","import app from 'flarum/forum/app';\nimport Rankings from \"./pages/Rankings\";\nimport RoundList from './pages/RoundList';\nimport RoundSettings from './pages/RoundSettings';\n\nexport default function () {\n    app.routes.catchTheFishRankings = {\n        path: '/catch-the-fish',\n        component: Rankings,\n    };\n\n    app.routes.catchTheFishRounds = {\n        path: '/catch-the-fish/rounds',\n        component: RoundList,\n    };\n\n    app.routes.catchTheFishRound = {\n        path: '/catch-the-fish/rounds/:id',\n        component: RoundSettings,\n    };\n}\n","import {override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport RoundAlert from './components/RoundAlert';\n\nexport default function () {\n    override(IndexPage.prototype, 'hero', function (original: any) {\n        const existing = original();\n\n        if (!app.forum.attribute('catchTheFishAlertRound')) {\n            return existing;\n        }\n\n        const rounds = app.forum.catchTheFishActiveRounds();\n\n        if (!rounds) {\n            return existing;\n        }\n\n        // Replace missing rounds with null. Happens if you delete a round and go back to homepage\n        const additional = rounds.map(round => round ? m(RoundAlert, {\n            round,\n        }) : null);\n\n        if (Array.isArray(existing)) {\n            return rounds.concat(existing);\n        }\n\n        return m('div', [\n            additional,\n            existing,\n        ]);\n    });\n}\n"],"names":["module","exports","e","t","a","n","d","lastDay","sameDay","nextDay","nextWeek","lastWeek","sameElse","prototype","calendar","this","$locale","o","startOf","s","diff","i","f","l","call","format","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","key","Object","defineProperty","enumerable","get","obj","prop","hasOwnProperty","r","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Fish","round_id","Model","placement","name","image_url","canSee","canCatch","canName","canPlace","placeUntil","namedBy","placedBy","round","placementModel","apiEndpoint","exists","data","id","attributes","Ranking","catch_count","user","Round","starts_at","ends_at","include_starting_pack","myRanking","translationPrefix","FishImage","view","vnode","src","attrs","fish","m","alt","extractText","app","style","animationDuration","draggable","Basket","basket","fishesThatCanBePlaced","filter","length","map","ondragstart","event","dataTransfer","setData","time","dayjs","fromNow","DropArea","User","Link","href","avatar","username","CaughtFishModal","newName","dirty","loading","oninit","className","title","saveNameAndPlacement","randomPlacement","body","method","url","then","result","hide","redraw","err","content","oninput","target","Button","type","onclick","onsubmit","preventDefault","Modal","MovingFish","reverseAnimation","Math","random","floor","classList","oncatch","alert","fishIdFromEvent","getData","match","exec","movingFishContent","dragover","model","push","fishes","catchTheFishFishes","forEach","pushData","relationships","addDropAttrs","modelProperty","ondrop","fishDragOver","fishId","ondragover","dropEffect","types","includes","ondragenter","ondragleave","addAreaToComponent","component","viewName","override","original","concat","extend","items","add","subtree","check","bind","vdom","RoundRankings","rankings","ranking","index","Rankings","rounds","Page","EditRound","processing","toISOString","saveRecord","withAttr","updateAttribute","Switch","state","onchange","disabled","readyToSave","deleteRecord","attribute","pushAttributes","save","onsave","confirm","ondelete","NewRoundModal","oncreateordelete","EditRoundModal","RoundList","refreshRounds","LinkButton","EditFish","NewFishModal","RoundSettings","roundId","uploading","route","param","refreshFishes","openPicker","callback","multiple","$input","$","attr","appendTo","click","on","files","uploadImages","images","FormData","append","serialize","raw","EditFishModal","Discussion","Post","discussion","number","UserModel","UpdateAlert","Forum","HeaderPrimary","CommentPost","UserCard","DiscussionHero","document","addEventListener","path","IndexPage","icon","existing","additional","RoundAlert","Array","isArray"],"sourceRoot":""}